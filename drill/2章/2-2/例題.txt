解答日：2019/05/13


Q:注文明細テーブル（order_desc）と商品テーブル(product)とから、
　商品ごとの累計購入数と累計購入額を、購入額が多い順に取り出してみましょう。
　なお、まったく売れていない商品についても取り出すものとします。


A:
SELECT									-- 選択命令句
 p.p_name,								-- 結合のテーブルから抽出する'商品名'カラムの指定
 SUM(o.quantity),						-- 結合後のテーブルから抽出する'購入数'カラムの指定と合計値を求める
 SUM(p.price * o.quantity)				-- 結合後のテーブルから抽出する'購入数'と'購入額'の累計額の集計関数
FROM									-- 抽出先指定命令句
 order_desc AS o						-- 抽出先テーブル名の指定と競合を防ぐためのテーブル名の修飾
RIGHT JOIN								-- 外部結合命令句
 product AS p							-- 外部結合するテーブル名の指定と競合を防ぐためのテーブル名の修飾
ON										-- 結合キー指定句
 p.p_id = o.p_id						-- 結合するキー同士の指定
GROUP BY								-- グルーピング命令句
 p.p_id,								-- データをグルーピングするためのキー列名の指定
 p.p_name								-- 2番目にグルーピングするためのキー列名の指定
ORDER BY								-- データ並び替え命令句
 SUM(p.price * o.quantity) DESC			-- 指定列の集計関数結果をもとに降順で並びかえする
;										-- 命令の終了を意味するセミコロン
